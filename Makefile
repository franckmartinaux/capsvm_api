##
##  Makefile -- Build procedure for sample capsvm_api Apache module
##  Autogenerated via ``apxs -n capsvm_api -g''.
##

builddir=.
top_srcdir=/etc/httpd
top_builddir=/usr/lib64/httpd
include /usr/lib64/httpd/build/special.mk

APACHECTL=apachectl

.PHONY: all libcapsvm capsvm_api clean restart

all: libcapsvm capsvm_api restart

libcapsvm: libcapsvm.a

libcapsvm.a: libcapsvm.o
	ar rcs $@ $^

libcapsvm.o: libcapsvm.c
	gcc -fPIC -c -g -Wincompatible-pointer-types -Wno-discarded-qualifiers -o $@ $<

capsvm_api: mod_capsvm_api.so

mod_capsvm_api.so: mod_capsvm_api.c libcapsvm.a
	apxs -c -i -I /usr/include -L /usr/lib64 -l sqlite3 -I /home/julien/capsvm_api -L /home/julien/capsvm_api -l capsvm -l config mod_capsvm_api.c
	cp .libs/mod_capsvm_api.so /etc/httpd/modules/

restart:
	sudo systemctl restart httpd

clean:
	rm -f *.o *.a *.so

restart:
	$(APACHECTL) restart
